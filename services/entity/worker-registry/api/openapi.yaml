openapi: 3.0.0

servers:
  - url: http://localhost:8080
    description: Local development server

info:
  version: 1.0.0
  title: Worker Registry API
  description: The API for the Worker Registry

paths:
  /worker:
    get:
      tags:
        - worker
      description: Returns all registered workers.
      operationId: getAllWorkers
      responses:
        '200':
          description: All registered workers
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Worker'
              example:
                - workerId: "101a8fa4-dce6-4d10-a65a-e88e6edbcdf7"
                  workerStatus: "Running"
                - workerId: "06842e74-1121-4700-b6d5-6558c8af6198"
                  workerStatus: "Stopped"
                - workerId: "06842e74-1121-4700-b6d5-6558c8af6199"
                  workerStatus: "Ready"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              example:
                message: "Internal server error"

    post:
      tags:
        - worker
      description: Registers a new Worker in the Worker Registry. Creates a unique Id and marks newly created worker as "Ready".
      operationId: saveWorker
      responses:
        '201':
          description: Worker successfully saved.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Worker'
              example:
                workerId: "90bb1e74-22f1-4b91-bf0b-fd17e542cb3e"
                workerStatus: "Ready"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              example:
                message: "Internal server error"

  /worker/{status}:
    get:
      tags:
        - worker
      description: Returns all workers with the specified status
      operationId: getAllWorkersByStatus
      parameters:
        - name: status
          in: path
          description: The status of the workers.
          required: true
          schema:
            type: string
      responses:
        '200':
          description: All registered workers with specified status
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Worker'
              example:
                - workerId: "101a8fa4-dce6-4d10-a65a-e88e6edbcdf7"
                  workerStatus: "Ready"
                - workerId: "06842e74-1121-4700-b6d5-6558c8af6198"
                  workerStatus: "Ready"
                - workerId: "06842e74-1121-4700-b6d5-6558c8af6199"
                  workerStatus: "Ready"
        '404':
          description: Worker was not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              example:
                message: "Worker not found"

  /worker/{workerId}/status:
    get:
      tags:
        - worker
      description: Retrieves the status of the specified worker.
      operationId: getWorkerStatus
      parameters:
        - name: workerId
          in: path
          description: The identifier of the worker.
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Worker status retrieved successfully.
          content:
            application/json:
              schema:
                type: object
                properties:
                  workerStatus:
                    type: string
                    enum:
                      - Ready
                      - Running
                      - Stopped
              example:
                workerStatus: "Ready"
        '404':
          description: Worker was not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              example:
                message: "Worker not found"

    patch:
      tags:
        - worker
      description: Updates the status of a specific worker to "Ready", "Running" or "Stopped".
      operationId: updateWorkerStatus
      parameters:
        - name: workerId
          in: path
          description: The identifier of the worker.
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workerStatus:
                  type: string
                  enum:
                    - Ready
                    - Running
                    - Stopped
              required:
                - workerStatus
            example:
              workerStatus: "Running"
      responses:
        '200':
          description: Worker status updated successfully.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Worker'
              example:
                workerId: "101a8fa4-dce6-4d10-a65a-e88e6edbcdf7"
                workerStatus: "Running"
        '404':
          description: Worker was not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              example:
                message: "Worker not found"
        '400':
          description: Invalid worker status provided.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
              example:
                message: "Invalid value for workerStatus. Allowed values are 'Ready', 'Running' or 'Stopped'."

components:
  schemas:
    Worker:
      type: object
      description: Worker details
      properties:
        workerId:
          type: string
          format: uuid
        workerStatus:
          type: string
          enum:
            - Ready
            - Running
            - Stopped
      example:
        workerId: "101a8fa4-dce6-4d10-a65a-e88e6edbcdf7"
        workerStatus: "Running"
